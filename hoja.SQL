CREATE DATABASE CAMPEONAT
USE CAMPEONAT



/****** Object:  Table [dbo].[ESTADIO]    Script Date: 09/16/2011 20:18:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[ESTADIO](
	[C_ESTADIO] [char](3) UNIQUE,
	[N_ESTADIO] [varchar](220)NULL,
PRIMARY KEY CLUSTERED 
(
	[C_ESTADIO] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO

SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[EQUIPO]    Script Date: 09/16/2011 20:18:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[EQUIPO](
	[C_EQUIPO] [char](2) NOT NULL,
	[N_EQUIPO] [varchar](220) DEFAULT 'NOMBRE',
PRIMARY KEY CLUSTERED 
(
	[C_EQUIPO] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[CAMPEONATO]    Script Date: 09/16/2011 20:18:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[CAMPEONATO](
	[C_CAMPEONATO] [char](3) NOT NULL,
	[N_CAMPEONATO] [varchar](220) NULL,
	[Q_PARTIDOS] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[C_CAMPEONATO] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[JUGADOR]    Script Date: 09/16/2011 20:18:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[JUGADOR](
	[C_JUGADOR] [char](3) NOT NULL,
	[N_JUGADOR] [varchar](220) NULL,
	[D_NACIMIENTO] [date] NULL,
PRIMARY KEY CLUSTERED 
(
	[C_JUGADOR] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[JUG_EQ_CAMP]    Script Date: 09/16/2011 20:18:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[JUG_EQ_CAMP](
	[C_JUGADOR] [char](3) NOT NULL,
	[C_CAMPEONATO] [char](3) NOT NULL,
	[C_EQUIPO] [char](2) NULL,
PRIMARY KEY CLUSTERED 
(
	[C_JUGADOR] ASC,
	[C_CAMPEONATO] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[PARTIDO]    Script Date: 09/16/2011 20:18:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[PARTIDO](
	[NRO_PARTIDO] [int] NOT NULL,
	[C_ESTADIO_PART] [char](3) NULL,
	[C_EQUIPO_1] [char](2) NULL,
	[C_EQUIPO_2] [char](2) NULL,
	[C_CAMPEONATO] [char](3) NULL,
	[D_PARTIDO] [date] NULL,
	[N_JUEZ_LINEA1] [varchar](250) NULL,
	[N_JUEZ_LINEA2] [varchar](250) NULL,
	[Q_GOLES_E1] [int] NULL CHECK(Q_GOLES_E1 > 0),
	[Q_GOLES_E2] [int] NULL,
	[N_ARBITRO] [varchar](220) NULL,
	[C_RESULTADO] [varchar](20) NULL,
PRIMARY KEY CLUSTERED 
(
	[NRO_PARTIDO] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
/****** Object:  Table [dbo].[JUG_PARTIDO]    Script Date: 09/16/2011 20:18:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[JUG_PARTIDO](
	[C_JUGADOR] [char](3) NOT NULL,
	[NRO_PARTIDO] [int] NOT NULL,
	[N_POSICION] [varchar](220) NULL,
	[NRO_CAMISETA] [int] NOT NULL,
	[F_EXPULSADO] [char](1) NULL,
	[F_AMONESTADO] [char](1) NULL,
	[F_GOLEADOR] [char](1) NULL,
PRIMARY KEY CLUSTERED 
(
	[C_JUGADOR] ASC,
	[NRO_PARTIDO] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO


/****** Object:  ForeignKey [FK_JUG_EQ_CAC_CAM_0DAF0CB0]    Script Date: 09/16/2011 20:18:30 ******/
ALTER TABLE [dbo].[JUG_EQ_CAMP]  WITH CHECK ADD FOREIGN KEY([C_CAMPEONATO])
REFERENCES [dbo].[CAMPEONATO] ([C_CAMPEONATO])
GO
/****** Object:  ForeignKey [FK_JUG_EQ_CAC_EQU_0EA330E9]    Script Date: 09/16/2011 20:18:30 ******/
ALTER TABLE [dbo].[JUG_EQ_CAMP]  WITH CHECK ADD FOREIGN KEY([C_EQUIPO])
REFERENCES [dbo].[EQUIPO] ([C_EQUIPO])
GO
/****** Object:  ForeignKey [FK_JUG_EQ_CAC_JUG_0CBAE877]    Script Date: 09/16/2011 20:18:30 ******/
ALTER TABLE [dbo].[JUG_EQ_CAMP]  WITH CHECK ADD FOREIGN KEY([C_JUGADOR])
REFERENCES [dbo].[JUGADOR] ([C_JUGADOR])
GO
/****** Object:  ForeignKey [FK_PARTIDOC_CAMPE_1A14E395]    Script Date: 09/16/2011 20:18:30 ******/
ALTER TABLE [dbo].[PARTIDO]  WITH CHECK ADD FOREIGN KEY([C_CAMPEONATO])
REFERENCES [dbo].[CAMPEONATO] ([C_CAMPEONATO])
GO
/****** Object:  ForeignKey [FK_PARTIDOC_EQUIP_182C9B23]    Script Date: 09/16/2011 20:18:30 ******/
ALTER TABLE [dbo].[PARTIDO]  WITH CHECK ADD FOREIGN KEY([C_EQUIPO_1])
REFERENCES [dbo].[EQUIPO] ([C_EQUIPO])
GO
/****** Object:  ForeignKey [FK_PARTIDOC_EQUIP_1920BF5C]    Script Date: 09/16/2011 20:18:30 ******/
ALTER TABLE [dbo].[PARTIDO]  WITH CHECK ADD FOREIGN KEY([C_EQUIPO_2])
REFERENCES [dbo].[EQUIPO] ([C_EQUIPO])
GO
/****** Object:  ForeignKey [FK_PARTIDOC_ESTAD_173876EA]    Script Date: 09/16/2011 20:18:30 ******/
ALTER TABLE [dbo].[PARTIDO]  WITH CHECK ADD FOREIGN KEY([C_ESTADIO_PART])
REFERENCES [dbo].[ESTADIO] ([C_ESTADIO])
GO
/****** Object:  ForeignKey [FK_JUG_PARTIC_JUG_1ED998B2]    Script Date: 09/16/2011 20:18:30 ******/
ALTER TABLE [dbo].[JUG_PARTIDO]  WITH CHECK ADD FOREIGN KEY([C_JUGADOR])
REFERENCES [dbo].[JUGADOR] ([C_JUGADOR])
GO
/****** Object:  ForeignKey [FK_JUG_PARTINRO_P_1FCDBCEB]    Script Date: 09/16/2011 20:18:30 ******/
ALTER TABLE [dbo].[JUG_PARTIDO]  WITH CHECK ADD FOREIGN KEY([NRO_PARTIDO])
REFERENCES [dbo].[PARTIDO] ([NRO_PARTIDO])
GO



-- AGREGADO ESTADIO -> LISTO
INSERT INTO ESTADIO (C_ESTADIO, N_ESTADIO) VALUES ('E01','ESTADIO DE CUNAMA')
INSERT INTO ESTADIO (C_ESTADIO, N_ESTADIO) VALUES ('E02', 'ESTADIO CIUDAD LEONCIO PRADO')

-- AGREGADO JUGADOR -> LISTO
INSERT INTO JUGADOR(C_JUGADOR, N_JUGADOR, D_NACIMIENTO) VALUES ('J01', 'RUBEN MENDOZA', '11/12/2001');
INSERT INTO JUGADOR(C_JUGADOR, N_JUGADOR, D_NACIMIENTO) VALUES ('J02', 'JUSTINIANO QUISPE', '02/11/2002');
INSERT INTO JUGADOR(C_JUGADOR, N_JUGADOR, D_NACIMIENTO) VALUES ('J03', 'JOHN AVENDA�O', '03/12/2000');
INSERT INTO JUGADOR(C_JUGADOR, N_JUGADOR, D_NACIMIENTO) VALUES ('J04', 'ANDEERSON ASTO', '02/12/1999');
INSERT INTO JUGADOR(C_JUGADOR, N_JUGADOR, D_NACIMIENTO) VALUES ('J05', 'DIEGO PALOMINO', '01/11/2002');
INSERT INTO JUGADOR(C_JUGADOR, N_JUGADOR, D_NACIMIENTO) VALUES ('J06', 'CALUDIO VELARDE', '06/02/2001');

INSERT INTO JUGADOR(C_JUGADOR, N_JUGADOR, D_NACIMIENTO) VALUES ('J07', 'ISAAC MARTINEZ', '06/11/2002');
INSERT INTO JUGADOR(C_JUGADOR, N_JUGADOR, D_NACIMIENTO) VALUES ('J08', 'LUIS FLORES', '06/09/2001');
INSERT INTO JUGADOR(C_JUGADOR, N_JUGADOR, D_NACIMIENTO) VALUES ('J09', 'MARCOS PACHECO', '08/11/2003');
INSERT INTO JUGADOR(C_JUGADOR, N_JUGADOR, D_NACIMIENTO) VALUES ('J10', 'RAUL ALARCON', '09/02/2002');
INSERT INTO JUGADOR(C_JUGADOR, N_JUGADOR, D_NACIMIENTO) values ('J11', 'EDGAR JANAMPA', '08/01/1999');
INSERT INTO JUGADOR(C_JUGADOR, N_JUGADOR, D_NACIMIENTO) values ('J12', 'PEPE ALANYA', '11/11/2000');

-- AGREGAR CAMPEONATO -> LISTO
INSERT INTO CAMPEONATO (C_CAMPEONATO, N_CAMPEONATO, Q_PARTIDOS) VALUES ('C01', 'CAMPEONATO INTIRAYMI AYACUCHO', 7);
INSERT INTO CAMPEONATO (C_CAMPEONATO, N_CAMPEONATO, Q_PARTIDOS) VALUES ('C02', 'CAMPEONATO COPA AMATEUR', 30);

-- AGREGAR EQUIPO -> LISTO
INSERT INTO EQUIPO (C_EQUIPO, N_EQUIPO) VALUES ('E1', 'URPOS FC');
INSERT INTO EQUIPO (C_EQUIPO, N_EQUIPO) VALUES ('E2', DEFAULT);	

-- AGREGAR JUG_EQ_CAMP -> LISTO
INSERT INTO JUG_EQ_CAMP (C_JUGADOR, C_CAMPEONATO, C_EQUIPO) VALUES ('J01', 'C01', 'E1');
INSERT INTO JUG_EQ_CAMP (C_JUGADOR, C_CAMPEONATO, C_EQUIPO) VALUES ('J02', 'C01', 'E1');
INSERT INTO JUG_EQ_CAMP (C_JUGADOR, C_CAMPEONATO, C_EQUIPO) VALUES ('J03', 'C01', 'E1');
INSERT INTO JUG_EQ_CAMP (C_JUGADOR, C_CAMPEONATO, C_EQUIPO) VALUES ('J04', 'C01', 'E1');
INSERT INTO JUG_EQ_CAMP (C_JUGADOR, C_CAMPEONATO, C_EQUIPO) VALUES ('J05', 'C01', 'E1');
INSERT INTO JUG_EQ_CAMP (C_JUGADOR, C_CAMPEONATO, C_EQUIPO) VALUES ('J06', 'C01', 'E1');

INSERT INTO JUG_EQ_CAMP (C_JUGADOR, C_CAMPEONATO, C_EQUIPO) VALUES ('J07', 'C01', 'E2');
INSERT INTO JUG_EQ_CAMP (C_JUGADOR, C_CAMPEONATO, C_EQUIPO) VALUES ('J08', 'C01', 'E2');
INSERT INTO JUG_EQ_CAMP (C_JUGADOR, C_CAMPEONATO, C_EQUIPO) VALUES ('J09', 'C01', 'E2');
INSERT INTO JUG_EQ_CAMP (C_JUGADOR, C_CAMPEONATO, C_EQUIPO) VALUES ('J10', 'C01', 'E2');
INSERT INTO JUG_EQ_CAMP (C_JUGADOR, C_CAMPEONATO, C_EQUIPO) VALUES ('J11', 'C01', 'E2');
INSERT INTO JUG_EQ_CAMP (C_JUGADOR, C_CAMPEONATO, C_EQUIPO) VALUES ('J12', 'C01', 'E2');

-- JUG_PARTIDO -> LISTO
INSERT INTO PARTIDO VALUES (1, 'E01', 'E1', 'E2', 'C01', '10/11/2022', 'PEDRO CASTILLO', 'KEIKO FUJIMORI', 1,2, 'ANIBAL SAGASTI', 'MUCHA LLUVIA TARDE');
INSERT INTO JUG_PARTIDO VALUES ('J01', 1, 'ARQUERO', 1,0,0,1);
INSERT INTO JUG_PARTIDO VALUES ('J02', 1, 'DEFENSA', 4,1,1,0);
INSERT INTO JUG_PARTIDO VALUES ('J03', 1, 'DELANTERO', 10,0,1,0);
INSERT INTO JUG_PARTIDO VALUES ('J04', 1, 'DEFENSA', 11,0,1,0);
INSERT INTO JUG_PARTIDO VALUES ('J05', 1, 'DEFENSA', 14,0,0,2);
INSERT INTO JUG_PARTIDO VALUES ('J06', 1, 'DELANTERO', 24,0,0,0);

INSERT INTO JUG_PARTIDO VALUES ('J07', 1, 'ARQUERO', 1,0,1,0);
INSERT INTO JUG_PARTIDO VALUES ('J08', 1, 'DEFENSA', 2,0,0,3);
INSERT INTO JUG_PARTIDO VALUES ('J09', 1, 'DELANTERO', 10,0,1,1);
INSERT INTO JUG_PARTIDO VALUES ('J10', 1, 'DEFENSA', 11,0,1,2);
INSERT INTO JUG_PARTIDO VALUES ('J11', 1, 'DEFENSA', 14,0,1,0);
INSERT INTO JUG_PARTIDO VALUES ('J12', 1, 'DELANTERO', 24,0,0,2);

-- CONFIGURAR

UPDATE JUGADOR SET N_JUGADOR = 'RAUL ALARCON' WHERE C_JUGADOR = 'J10';

SELECT * FROM ESTADIO

SELECT * FROM JUGADOR ORDER BY N_JUGADOR 

SELECT * FROM CAMPEONATO
SELECT * FROM EQUIPO
SELECT * FROM JUG_EQ_CAMP
SELECT * FROM PARTIDO
SELECT * FROM JUG_PARTIDO


SELECT DAY(GETDATE()) AS 'Tabla D�a';
SELECT MONTH(GETDATE()) AS 'Tabla Mes';
SELECT YEAR(GETDATE()) AS 'Tabla A�o';

SELECT DATEPART(DAY,GETDATE()) AS 'D�a';
SELECT DATEPART(YEAR,GETDATE()) AS 'A�o';
SELECT DATEPART(WEEK,GETDATE()) AS 'Semana';

SELECT DATEDIFF(DAY, '06/09/2001', '06/11/2002') AS 'Diferencia de D�as';
SELECT DATEDIFF(MONTH,'06/09/2001', '06/11/2002') AS 'Diferencia de Meses';
SELECT DATEDIFF(YEAR,'06/09/2001', '06/11/2002') AS 'Diferencias de A�os';

SELECT * FROM JUG_PARTIDO WHERE F_GOLEADOR < 2 
SELECT * FROM JUG_PARTIDO WHERE F_GOLEADOR > 2
SELECT * FROM JUG_PARTIDO WHERE F_GOLEADOR <> 2
SELECT * FROM JUG_PARTIDO WHERE F_GOLEADOR = 2
SELECT * FROM JUG_PARTIDO WHERE F_GOLEADOR <= 2
SELECT * FROM JUG_PARTIDO WHERE F_GOLEADOR >= 2

SELECT  dbo.JUGADOR.C_JUGADOR, dbo.JUGADOR.N_JUGADOR, dbo.JUG_EQ_CAMP.C_JUGADOR
FROM dbo.JUGADOR
INNER JOIN JUG_EQ_CAMP
ON dbo.JUGADOR.C_JUGADOR=dbo.JUG_EQ_CAMP.C_JUGADOR


CREATE VIEW test_vista1
AS
SELECT C_JUGADOR, N_JUGADOR FROM JUGADOR

SELECT * FROM test_vista1
SELECT * FROM JUGADOR